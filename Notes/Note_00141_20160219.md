### å˜æ›´è®°å½•

| åºå· | å½•å…¥æ—¶é—´ | å½•å…¥äºº | å¤‡æ³¨ |
|:--------:|:--------:|:--------:|:--------:|
| 1 | 2016-02-19 | [Alfred Jiang](https://github.com/viktyz) | - |

### æ–¹æ¡ˆåç§°

æ—¶é—´ - ä½¿ç”¨ Benchmarking ç²¾ç¡®æµ‹é‡çš„ä»£ç è¿è¡Œæ—¶é—´

### å…³é”®å­—

Benchmarking \ æµ‹é‡ \ ä»£ç è¿è¡Œæ—¶é—´

### éœ€æ±‚åœºæ™¯

1. éœ€è¦å¯¹å‡½æ•°è¿›è¡Œè¿è¡Œæ—¶é—´æµ‹é‡æ—¶
2. éœ€è¦æ¯”è¾ƒä¸¤ä¸ªå‡½æ•°è¿è¡Œæ—¶é—´æ—¶

### å‚è€ƒé“¾æ¥

1. [NSHipster - Benchmarking](http://nshipster.cn/benchmarking/)

### è¯¦ç»†å†…å®¹

##### 1. ä½¿ç”¨ CFAbsoluteTimeGetCurrent

å’Œ NSDate æˆ– CFAbsoluteTimeGetCurrent() åç§»é‡ä¸åŒçš„æ˜¯ï¼Œmach_absolute_time() å’Œ CACurrentMediaTime() æ˜¯åŸºäºå†…å»ºæ—¶é’Ÿçš„ï¼Œèƒ½å¤Ÿæ›´ç²¾ç¡®æ›´åŸå­åŒ–åœ°æµ‹é‡ï¼Œå¹¶ä¸”ä¸ä¼šå› ä¸ºå¤–éƒ¨æ—¶é—´å˜åŒ–è€Œå˜åŒ–ï¼ˆä¾‹å¦‚æ—¶åŒºå˜åŒ–ã€å¤æ—¶åˆ¶ã€ç§’çªå˜ç­‰ï¼‰

```objectivec
CFTimeInterval startTime = CACurrentMediaTime();
{
    static size_t const count = 1000;
    static size_t const iterations = 10000;

    id object = @"ğŸ·";

    for (size_t i = 0; i < iterations; i++) {
        @autoreleasepool {
            NSMutableArray *mutableArray = [NSMutableArray array];
            for (size_t j = 0; j < count; j++) {
                [mutableArray addObject:object];
            }
        }
    }
}
CFTimeInterval endTime = CACurrentMediaTime();
NSLog(@"Total Runtime: %g s", endTime - startTime);
```

##### 2. ä½¿ç”¨ dispatch_benchmark

dispatch_benchmark æ˜¯ libdispatch (Grand Central Dispatch) çš„ä¸€éƒ¨åˆ†ã€‚ä½†ä¸¥è‚ƒåœ°è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å¹¶æ²¡æœ‰è¢«å…¬å¼€å£°æ˜ï¼Œæ‰€ä»¥ä½ å¿…é¡»è¦è‡ªå·±å£°æ˜ï¼š

```objectivec
extern uint64_t dispatch_benchmark(size_t count, void (^block)(void));
```

ç›¸æ¯”ä¹‹å‰çš„ç§’è®¡æ—¶ï¼Œæ¯«å¾®ç§’æ›´åŠ ç²¾ç¡®ï¼Œdispatch_benchmark ä¹Ÿæ¯”æ‰‹åŠ¨å†™å¾ªç¯çš„ CFAbsoluteTimeGetCurrent() è¯­æ³•ç»“æ„ä¸Šçœ‹èµ·æ¥æ›´å¥½ã€‚

```objectivec
uint64_t t = dispatch_benchmark(iterations, ^{
    @autoreleasepool {
        NSMutableArray *mutableArray = [NSMutableArray array];
        for (size_t i = 0; i < count; i++) {
            [mutableArray addObject:object];
        }
    }
});
NSLog(@"[[NSMutableArray array] addObject:] Avg. Runtime: %llu ns", t);
```

### æ•ˆæœå›¾
ï¼ˆæ— ï¼‰

### å¤‡æ³¨
ï¼ˆæ— ï¼‰
